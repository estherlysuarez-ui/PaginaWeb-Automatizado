<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Cinta Transportadora Mecatrónica</title>
    <meta name="description" content="Simulación mecatrónica VR/AR">
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
  </head>
  <body>
    <a-scene background="color: #CFFCF8" embedded arjs="sourceType: webcam; debugUIEnabled: false">
      
      <!-- Cámara -->
      <a-entity camera position="0 4 8" look-controls></a-entity>
      
      <!-- Piso -->
      <a-plane position="0 0 0" rotation="-90 0 0" width="50" height="50" color="#C8E0E4" shadow></a-plane>
      
      <!-- Banda transportadora -->
      <a-box id="belt" position="0 1 0" depth="12" width="4" height="0.2" color="#333333" shadow
             material="repeat: 6 1; src: https://i.imgur.com/Fkx3dXG.png"></a-box>
      
      <!-- Rodillos -->
      <a-cylinder position="0 1 6" radius="0.3" height="4" rotation="90 0 0" color="#555555" shadow></a-cylinder>
      <a-cylinder position="0 1 -6" radius="0.3" height="4" rotation="90 0 0" color="#555555" shadow></a-cylinder>
      
      <!-- Objetos sobre la banda -->
      <a-box id="box1" position="-1 1.7 -5" depth="1" width="1" height="1" color="#FF6347" shadow></a-box>
      <a-sphere id="sphere1" position="1 1.7 -7" radius="0.5" color="#FFD700" shadow></a-sphere>
      <a-cone id="pyramid1" position="0 1.7 -9" radius-bottom="0.5" radius-top="0" height="1" color="#00CED1" shadow></a-cone>
      
      <!-- Luces -->
      <a-entity light="type: ambient; intensity: 0.5"></a-entity>
      <a-entity light="type: directional; intensity: 0.8; castShadow: true" position="5 10 5"></a-entity>
      
      <!-- Botones VR/AR -->
      <a-entity position="8 0 -8">
        <a-entity vr-mode-ui="enabled: true"></a-entity>
      </a-entity>
      
      <!-- Animación de objetos -->
      <script>
        AFRAME.registerComponent('move-belt', {
          schema: {speed: {type: 'number', default: 0.05}},
          tick: function(time, timeDelta) {
            const belt = document.querySelector('#belt');
            belt.getAttribute('material').offset = belt.getAttribute('material').offset || {x:0, y:0};
            belt.getAttribute('material').offset.y -= this.data.speed;

            const objects = ['#box1','#sphere1','#pyramid1'];
            objects.forEach(id => {
              const obj = document.querySelector(id);
              let pos = obj.getAttribute('position');
              pos.z += this.data.speed * 20 * (timeDelta/16);
              if(pos.z > 6) pos.z = -6;
              obj.setAttribute('position', pos);
            });
          }
        });

        document.querySelector('a-scene').setAttribute('move-belt','speed:0.02');
      </script>
    </a-scene>
  </body>
</html>
